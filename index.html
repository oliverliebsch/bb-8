<!DOCTYPE html>
<html lang='en-US'>
  <head>
    <meta charset='UTF-8'>
    <meta content='width=device-width' name='viewport'>
    <title>bb-8</title>
    <link href='styles.css' rel='stylesheet'>
    <script src='https://cdn.jsdelivr.net/lodash/4.17.2/lodash.min.js'></script>
    <script src='https://unpkg.com/vue@2.1.3/dist/vue.js'></script>
  </head>
  <body>
    <script id='template-controls' type='text/x-template'>
      <div>
        <a class='button' v-on:click='addBlock("heading")'>Heading</a>
        <a class='button' v-on:click='addBlock("subheading")'>Subheading</a>
        <a class='button' v-on:click='addBlock("single-image")'>Image</a>
      </div>
    </script>
    <script id='template-bb8' type='text/x-template'>
      <div>
        <slot>
          <textarea cols='100' name='text' rows='8' v-model='output'></textarea>
        </slot>
        <controls :index='-1'></controls>
        <hr>
        <div>
          <component :index='index' :initialData='block' :is='block.blocktype' :key='block.id' v-for='(block, index) in blocks'></component>
        </div>
      </div>
    </script>
    <script id='template-heading' type='text/x-template'>
      <div>
        <label>Heading</label>
        <input :value='block.fields[0].content' v-on:input='updateText($event.target.value)'>
        <controls :index='index'></controls>
        <hr>
      </div>
    </script>
    <script id='template-subheading' type='text/x-template'>
      <div>
        <label>Subheading</label>
        <input :value='block.fields[0].content' v-on:input='updateText($event.target.value)'>
        <controls :index='index'></controls>
        <hr>
      </div>
    </script>
    <script id='template-single-image' type='text/x-template'>
      <div>
        <label>Image</label>
        <input name='file' type='file' v-on:change='updateImage($event)'>
        <img :src='block.fields[1].content'>
        <label>Alt</label>
        <input :value='block.fields[0].content' v-on:input='updateText($event.target.value)'>
        <controls :index='index'></controls>
        <hr>
      </div>
    </script>
    <form id='bb8-form' v-on:submit='submit($event)'>
      <bb8 initial-json='[{"blocktype":"heading","id":1,"fields":[{"type":"text","content":"Test","required":true}]},{"blocktype":"subheading","id":2,"fields":[{"type":"text","content":"Blub","required":true}]},{"blocktype":"heading","id":3,"fields":[{"type":"text","content":"Bla","required":true}]}]'></bb8>
      <input type='submit' value='submit'>
    </form>
    <script src='bb-8.js'></script>
  </body>
</html>
